### 设计模式

- 单例模式：就是保证一个类只有一个实例，实现的方法一般是先判断实例存在与否，如果存在直接返回，如果不存在就创建了再返回，这就确保了一个类只有一个实例对象。在 JavaScript 里，单例作为一个命名空间提供者，从全局命名空间里提供一个唯一的访问点来访问该对象。
- 观察者模式: 观察者的使用场合就是：当一个对象的改变需要同时改变其它对象，并且它不知道具体有多少对象需要改变的时候，就应该考虑使用观察者模式。
- 工厂模式解决了重复实例化的问题，缺点，创建不同对象其中属性和方法都会重复建立，消耗内存；还有函数识别问题等等。

### diff 算法原理

> 用于比较两个虚拟 DOM 树之间的差异，并更新实际的 DOM 结构，以提高性能和效率

Diff 算法的关键在于遍历虚拟 DOM 树并比较节点的差异。

1. 对比两个节点的属性
2. 对比两个节点的字节点
3. 对比两个节点的 key

### websocket 通信原理

> WebSocket 是基于 TCP 的一种新的应用层网络协议。它实现了浏览器与服务器全双工通信，即允许服务器主动发送信息给客户端

WebSocket 的原理就是通过 HTTP 协议建立一个长连接，在这个连接上可以进行双向通信，从而实现实时通信和推送

- 常见问题：

Q：WebSocket 能全双工，为何普通 HTTP 请求不行？（他们建立在 TCP 协议之上的，TCP 协议本就实现了全双工通信）

A：其实是 HTTP 的“请求－应答模式”限制了 TCP 协议本支持的全双工通信。

Q：WebSocket 和 Socket 的区别

A：Socket 不是协议，是应用层与 TCP/IP 通信的中间软件抽象层，是一组接口。而 WebSocket 是应用层协议。

Q：WebSocket 长连接和 HTTP 长连接的区别

A：HTTP/1.1 默认开启了长连接（Connection:keep-alive），本质是 TCP 长连接，可在一次 TCP 连接中完成多个 HTTP 请求。

WebSocket 的长连接是真正的全双工，TCP 链路建立后，双方可以互发消息，无需再设置请求头，且双方都需要维持住这个连接。

- 建立过程
  1. 浏览器发起一个 http 请求建立连接 ，请求地址以 ws://开头，请求头 Upgrade: websocket 和 Connection: Upgrade 表示这个连接将要被转换为 WebSocket 连接。
  2. 服务器响应请求 响应头 HTTP/1.1 101 Switching Protocols 和 Upgrade: websocket 表示本次连接的 HTTP 协议即将被更改（代码 101），改为指定的 WebSocket 协议
